<div class="container">
    <header>Gestion des ventes</header>
    <div class="selectable-product-container">
        <main>
            <app-search-bar (search)="onSearch($event)"></app-search-bar>
            <app-loader [isLoading]="productsLoading$ | async">
                <app-selectable-product-list
                    [products]="products$ | async"
                    (add)="onAddProduct($event)"
                ></app-selectable-product-list>
            </app-loader>
        </main>
        <footer>
            <app-pagination
                [totalItems]="totalItems$ | async"
                (paginate)="onPaginate($event)"
            ></app-pagination>
        </footer>
    </div>
    <div class="selected-product-container">
        <app-selected-product-list
            [saleItems]="saleItems$ | async"
            (delete)="currentSaleItem = $event; deletionConfirmModal.open()"
            (cancel)="onCancelSale()"
        ></app-selected-product-list>
    </div>
</div>

<modal #cancelingConfirmModal class="popup-modal warning">
    <ng-template #modalHeader>
        Confirmation
    </ng-template>
    <ng-template #modalBody>
        Voulez vous vraiment annuler la commande en cours?
    </ng-template>
    <ng-template #modalFooter>
        <button class="blue" (click)="cancelingConfirmModal.close(); onConfirmCanceling()">
            OUI
        </button>
        <button class="dark-purple" (click)="cancelingConfirmModal.close()">NON</button>
    </ng-template>
</modal>

<modal #deletionConfirmModal class="popup-modal warning">
    <ng-template #modalHeader>
        Confirmation
    </ng-template>
    <ng-template #modalBody>
        Voulez vous vraiment supprimer cet element?
    </ng-template>
    <ng-template #modalFooter>
        <button class="blue" (click)="deletionConfirmModal.close(); onConfirmDeletion()">
            OUI
        </button>
        <button class="dark-purple" (click)="deletionConfirmModal.close()">NON</button>
    </ng-template>
</modal>

<modal #productAdditionErrorModal class="popup-modal error" [closeOnOutsideClick]="false">
    <ng-template #modalHeader>
        Echec
    </ng-template>
    <ng-template #modalBody>
        <p>
            {{ getError }}
        </p>
    </ng-template>
    <ng-template #modalFooter>
        <button (click)="onCloseProductAdditionErrorModal()" class="blue">OK</button>
    </ng-template>
</modal>
