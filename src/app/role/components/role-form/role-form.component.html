<div class="container" *ngIf="form">
    <div class="role-container">
        <form (submit)="onSubmit()" [formGroup]="form">
            <div class="controls" data-simplebar>
                <div class="control">
                    <label for="name">Nom *</label>
                    <input #first formControlName="name" id="name" type="text" />
                    <app-validation-error
                        [control]="form.controls['name']"
                        [customErrorLabels]="{ duplicateEntry: 'Ce nom existe déjà' }"
                    ></app-validation-error>
                </div>

                <div class="privilege-container" formGroupName="privileges">
                    <ul *ngFor="let category of categories" class="accordion">
                        <li [formArrayName]="category" class="has-children">
                            <input [id]="category" checked class="toggle" type="checkbox" />
                            <label [for]="category">
                                <span>{{ categoryLabels[category] | titlecase }}</span>
                                <div class="arrow"></div>
                            </label>
                            <ul>
                                <li
                                    *ngFor="
                                        let privilege of getCategoryPrivileges(category);
                                        let i = index
                                    "
                                    [formGroupName]="i"
                                >
                                    <input
                                        [id]="privilege.get('name').value"
                                        formControlName="active"
                                        type="checkbox"
                                    />
                                    <label [for]="privilege.get('name').value">
                                        {{
                                            userPrivilegeLabels[privilege.get('name').value]
                                                | titlecase
                                        }}
                                    </label>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </form>
    </div>
    <div class="button-container">
        <button
            class="blue"
            *ngIf="!form.enabled"
            (click)="edit.emit(form.value)"
        >
            MODIFIER
        </button>
        <button class="blue" *ngIf="form.enabled" (click)="onSubmit(form)">ENREGISTRER</button>
        <button class="dark-purple" *ngIf="form.enabled" (click)="cancel.emit()">
            ANNULER
        </button>
    </div>
</div>
